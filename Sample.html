<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChronoPulse | Precision Notification System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            overflow: hidden;
        }
        .mono {
            font-family: 'JetBrains Mono', monospace;
        }
        /* Glassmorphism */
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        
        /* Animations */
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(56, 189, 248, 0.2); }
            50% { box-shadow: 0 0 40px rgba(56, 189, 248, 0.6); }
        }
        
        @keyframes ring-shake {
            0% { transform: rotate(0deg); }
            10% { transform: rotate(15deg); }
            20% { transform: rotate(-15deg); }
            30% { transform: rotate(10deg); }
            40% { transform: rotate(-10deg); }
            50% { transform: rotate(5deg); }
            60% { transform: rotate(-5deg); }
            100% { transform: rotate(0deg); }
        }

        @keyframes slide-up {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .animate-ring {
            animation: ring-shake 0.8s ease-in-out infinite;
        }

        .animate-slide-up {
            animation: slide-up 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        /* Custom Scrollbar for inputs */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }

        /* Progress Ring */
        .progress-ring__circle {
            transition: stroke-dashoffset 0.35s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
    </style>
</head>
<body class="text-slate-200 h-screen w-screen flex items-center justify-center relative">

    <!-- Background Effects -->
    <div class="absolute inset-0 z-0">
        <div class="absolute top-[-10%] left-[-10%] w-96 h-96 bg-cyan-500/20 rounded-full blur-[100px]"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-purple-500/20 rounded-full blur-[100px]"></div>
    </div>

    <!-- Main Application Container -->
    <main class="relative z-10 w-full max-w-md p-6">
        
        <!-- Header -->
        <div class="text-center mb-8 animate-slide-up" style="animation-delay: 0.1s;">
            <h1 class="text-3xl font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-purple-400">
                CHRONO<span class="font-light text-white">PULSE</span>
            </h1>
            <p class="text-slate-400 text-xs mt-1 tracking-widest uppercase">Precision Notification System</p>
        </div>

        <!-- Timer Display Card -->
        <div class="glass rounded-3xl p-8 mb-6 relative overflow-hidden animate-slide-up" style="animation-delay: 0.2s;">
            <!-- SVG Progress Ring -->
            <div class="relative w-64 h-64 mx-auto flex items-center justify-center">
                <svg class="progress-ring w-full h-full" width="256" height="256">
                    <circle class="text-slate-700" stroke-width="8" stroke="currentColor" fill="transparent" r="120" cx="128" cy="128"/>
                    <circle id="progress-circle" class="text-cyan-400 progress-ring__circle" stroke-width="8" stroke-linecap="round" stroke="currentColor" fill="transparent" r="120" cx="128" cy="128"/>
                </svg>
                
                <!-- Digital Time Display -->
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                    <div id="timer-display" class="mono text-5xl font-bold text-white tracking-tighter drop-shadow-lg">00:00:00</div>
                    <div id="status-label" class="text-cyan-400 text-xs font-bold tracking-widest mt-2 uppercase">Ready</div>
                </div>
            </div>
        </div>

        <!-- Controls Section -->
        <div id="controls-panel" class="glass rounded-2xl p-6 animate-slide-up transition-all duration-300" style="animation-delay: 0.3s;">
            
            <!-- Input Mode -->
            <div id="input-section" class="space-y-4">
                <div class="grid grid-cols-3 gap-4">
                    <div class="flex flex-col items-center">
                        <label class="text-xs text-slate-400 mb-1 uppercase font-bold">Hrs</label>
                        <input type="number" id="input-hrs" min="0" max="99" value="0" class="w-full bg-slate-800/50 border border-slate-600 rounded-lg p-3 text-center text-xl font-bold focus:border-cyan-400 focus:outline-none transition-colors">
                    </div>
                    <div class="flex flex-col items-center">
                        <label class="text-xs text-slate-400 mb-1 uppercase font-bold">Min</label>
                        <input type="number" id="input-min" min="0" max="59" value="5" class="w-full bg-slate-800/50 border border-slate-600 rounded-lg p-3 text-center text-xl font-bold focus:border-cyan-400 focus:outline-none transition-colors">
                    </div>
                    <div class="flex flex-col items-center">
                        <label class="text-xs text-slate-400 mb-1 uppercase font-bold">Sec</label>
                        <input type="number" id="input-sec" min="0" max="59" value="0" class="w-full bg-slate-800/50 border border-slate-600 rounded-lg p-3 text-center text-xl font-bold focus:border-cyan-400 focus:outline-none transition-colors">
                    </div>
                </div>

                <!-- Sound Toggle -->
                <div class="flex items-center justify-between bg-slate-800/30 p-3 rounded-lg border border-slate-700/50">
                    <div class="flex items-center gap-3">
                        <div class="p-2 bg-slate-700 rounded-full text-cyan-400">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                            </svg>
                        </div>
                        <span class="text-sm font-medium text-slate-300">Enable Audio Alert</span>
                    </div>
                    <button id="sound-toggle" class="w-12 h-6 rounded-full bg-cyan-500 relative transition-colors duration-300 focus:outline-none">
                        <div class="w-4 h-4 bg-white rounded-full absolute top-1 left-7 transition-all duration-300 shadow-md"></div>
                    </button>
                </div>

                <button id="start-btn" class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-cyan-500/30 transform transition hover:scale-[1.02] active:scale-95">
                    INITIATE COUNTDOWN
                </button>
            </div>

            <!-- Active Mode Controls (Hidden initially) -->
            <div id="active-controls" class="hidden grid-cols-2 gap-4">
                <button id="pause-btn" class="bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-xl transition-colors border border-slate-600">
                    PAUSE
                </button>
                <button id="reset-btn" class="bg-red-500/20 hover:bg-red-500/30 text-red-400 border border-red-500/50 font-bold py-3 rounded-xl transition-colors">
                    ABORT
                </button>
            </div>
        </div>
    </main>

    <!-- Alarm Overlay (Hidden) -->
    <div id="alarm-overlay" class="fixed inset-0 z-50 bg-slate-900/95 backdrop-blur-xl hidden flex-col items-center justify-center">
        <div class="relative">
            <!-- Visual Sound Waves -->
            <div class="absolute inset-0 flex items-center justify-center">
                <div class="w-32 h-32 bg-cyan-500/20 rounded-full animate-ping"></div>
            </div>
            <div class="absolute inset-0 flex items-center justify-center delay-75">
                <div class="w-48 h-48 bg-purple-500/20 rounded-full animate-ping"></div>
            </div>
            
            <!-- Icon -->
            <div class="relative z-10 text-cyan-400 animate-ring mb-8">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-32 w-32 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                </svg>
            </div>
        </div>

        <h2 class="text-4xl md:text-6xl font-bold text-white mb-2 tracking-tight text-center">TIME'S UP</h2>
        <p class="text-cyan-400 text-lg mb-12 tracking-widest uppercase">Sequence Complete</p>

        <button id="dismiss-btn" class="px-12 py-4 bg-white text-slate-900 font-bold text-xl rounded-full hover:scale-105 transition-transform shadow-[0_0_40px_rgba(255,255,255,0.3)]">
            DISMISS ALARM
        </button>
    </div>

    <script>
        // --- Audio Engine (Web Audio API) ---
        // We use this to generate a sound without external files, ensuring it works reliably.
        const AudioEngine = {
            ctx: null,
            isMuted: false,
            osc: null,
            gainNode: null,
            intervalId: null,

            init() {
                if (!this.ctx) {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
                if (this.ctx.state === 'suspended') {
                    this.ctx.resume();
                }
            },

            playAlarm() {
                this.init();
                if (this.isMuted) return;

                // Create a rhythmic beeping pattern
                this.intervalId = setInterval(() => {
                    this.beep(800, 0.1); // High pitch, short
                    setTimeout(() => this.beep(600, 0.1), 150); // Lower pitch, short
                    setTimeout(() => this.beep(800, 0.1), 300); // High pitch, short
                }, 1000);
            },

            beep(freq, duration) {
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();

                osc.type = 'square'; // Retro alarm sound
                osc.frequency.setValueAtTime(freq, this.ctx.currentTime);

                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + duration);

                osc.connect(gain);
                gain.connect(this.ctx.destination);

                osc.start();
                osc.stop(this.ctx.currentTime + duration);
            },

            stopAlarm() {
                if (this.intervalId) {
                    clearInterval(this.intervalId);
                    this.intervalId = null;
                }
            },

            toggleMute() {
                this.isMuted = !this.isMuted;
                return this.isMuted;
            }
        };

        // --- Timer Logic ---
        const Timer = {
            totalSeconds: 0,
            remainingSeconds: 0,
            intervalId: null,
            isRunning: false,
            isPaused: false,

            // DOM Elements
            display: document.getElementById('timer-display'),
            circle: document.getElementById('progress-circle'),
            status: document.getElementById('status-label'),
            inputSection: document.getElementById('input-section'),
            activeControls: document.getElementById('active-controls'),
            alarmOverlay: document.getElementById('alarm-overlay'),
            
            // Inputs
            inputHrs: document.getElementById('input-hrs'),
            inputMin: document.getElementById('input-min'),
            inputSec: document.getElementById('input-sec'),

            // Circle Props
            radius: 120,
            circumference: 2 * Math.PI * 120,

            init() {
                this.circle.style.strokeDasharray = `${this.circumference} ${this.circumference}`;
                this.circle.style.strokeDashoffset = 0;
                this.updateDisplay(0);
            },

            start() {
                if (this.isRunning && !this.isPaused) return;

                AudioEngine.init(); // Initialize audio context on user gesture

                if (!this.isPaused) {
                    // Fresh start
                    const h = parseInt(this.inputHrs.value) || 0;
                    const m = parseInt(this.inputMin.value) || 0;
                    const s = parseInt(this.inputSec.value) || 0;
                    this.totalSeconds = (h * 3600) + (m * 60) + s;
                    
                    if (this.totalSeconds <= 0) {
                        this.shakeInputs();
                        return;
                    }
                    this.remainingSeconds = this.totalSeconds;
                }

                this.isRunning = true;
                this.isPaused = false;
                this.updateUIState('running');
                
                this.intervalId = setInterval(() => this.tick(), 1000);
            },

            tick() {
                this.remainingSeconds--;
                this.updateDisplay(this.remainingSeconds);
                this.updateProgress();

                if (this.remainingSeconds <= 0) {
                    this.complete();
                }
            },

            pause() {
                if (!this.isRunning) return;
                clearInterval(this.intervalId);
                this.isPaused = true;
                this.isRunning = false;
                this.updateUIState('paused');
            },

            reset() {
                clearInterval(this.intervalId);
                this.isRunning = false;
                this.isPaused = false;
                this.remainingSeconds = 0;
                this.totalSeconds = 0;
                this.updateDisplay(0);
                this.updateProgress();
                this.updateUIState('idle');
                AudioEngine.stopAlarm();
            },

            complete() {
                clearInterval(this.intervalId);
                this.isRunning = false;
                this.updateDisplay(0);
                this.updateProgress();
                this.triggerAlarm();
            },

            triggerAlarm() {
                this.alarmOverlay.classList.remove('hidden');
                this.alarmOverlay.classList.add('flex');
                AudioEngine.playAlarm();
                
                // Try browser notification if permitted
                if (Notification.permission === "granted") {
                    new Notification("ChronoPulse", { body: "Timer Complete!" });
                } else if (Notification.permission !== "denied") {
                    Notification.requestPermission().then(permission => {
                        if (permission === "granted") {
                            new Notification("ChronoPulse", { body: "Timer Complete!" });
                        }
                    });
                }
            },

            dismissAlarm() {
                this.alarmOverlay.classList.add('hidden');
                this.alarmOverlay.classList.remove('flex');
                AudioEngine.stopAlarm();
                this.reset();
            },

            updateDisplay(seconds) {
                const h = Math.floor(seconds / 3600);
                const m = Math.floor((seconds % 3600) / 60);
                const s = seconds % 60;
                
                const strH = h.toString().padStart(2, '0');
                const strM = m.toString().padStart(2, '0');
                const strS = s.toString().padStart(2, '0');
                
                this.display.textContent = `${strH}:${strM}:${strS}`;
                document.title = `(${strH}:${strM}:${strS}) ChronoPulse`;
            },

            updateProgress() {
                if (this.totalSeconds === 0) {
                    this.circle.style.strokeDashoffset = 0;
                    return;
                }
                const offset = this.circumference - (this.remainingSeconds / this.totalSeconds) * this.circumference;
                this.circle.style.strokeDashoffset = offset;
            },

            updateUIState(state) {
                if (state === 'running') {
                    this.inputSection.classList.add('hidden');
                    this.activeControls.classList.remove('hidden');
                    this.activeControls.classList.add('grid');
                    this.status.textContent = "Running";
                    this.status.className = "text-green-400 text-xs font-bold tracking-widest mt-2 uppercase animate-pulse";
                    this.display.classList.add('text-cyan-300');
                    this.display.classList.remove('text-white');
                } else if (state === 'paused') {
                    this.status.textContent = "Paused";
                    this.status.className = "text-yellow-400 text-xs font-bold tracking-widest mt-2 uppercase";
                    this.display.classList.remove('text-cyan-300');
                    this.display.classList.add('text-white');
                    document.getElementById('pause-btn').textContent = "RESUME";
                } else if (state === 'idle') {
                    this.inputSection.classList.remove('hidden');
                    this.activeControls.classList.add('hidden');
                    this.activeControls.classList.remove('grid');
                    this.status.textContent = "Ready";
                    this.status.className = "text-cyan-400 text-xs font-bold tracking-widest mt-2 uppercase";
                    this.display.classList.remove('text-cyan-300');
                    this.display.classList.add('text-white');
                    document.getElementById('pause-btn').textContent = "PAUSE";
                }
            },

            shakeInputs() {
                const panel = document.getElementById('controls-panel');
                panel.animate([
                    { transform: 'translateX(0)' },
                    { transform: 'translateX(-10px)' },
                    { transform: 'translateX(10px)' },
                    { transform: 'translateX(0)' }
                ], { duration: 300 });
            }
        };

        // --- Event Listeners ---
        document.getElementById('start-btn').addEventListener('click', () => Timer.start());
        document.getElementById('pause-btn').addEventListener('click', () => {
            if (Timer.isRunning) Timer.pause();
            else Timer.start(); // Resume
        });
        document.getElementById('reset-btn').addEventListener('click', () => Timer.reset());
        document.getElementById('dismiss-b
